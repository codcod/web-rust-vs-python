= Comparison of web development with Rust vs Python

Not scientific at all.

Rust web app made with:

* https://actix.rs[Actix] (non-async)
* https://github.com/launchbadge/sqlx[SQLx]

Python web app made with:

* https://docs.aiohttp.org/en/stable/[Aiohttp] (async)
* https://www.sqlalchemy.org[SQLAlchemy]
* https://alembic.sqlalchemy.org/en/latest/[Alembic]
* https://magicstack.github.io/asyncpg/current/[asyncpg]

Both web apps use the same database:

* https://www.postgresql.org[PostgreSQL]


== How to run the code

Rust.

[source, bash]
----
$ # git clone && cd web-rust
$ cargo build --release
$ ./target/release/web-rust
$ open http://127.0.0.1:8080
----

Python.

[source, bash]
----
$ # git clone && cd web-python
$ make venv
$ source .venv/bin/activate
$ alembic upgrade ec5ddda825ce
$ ./scripts/run
$ open http://127.0.0.1:8080
----

Stress test it with:

[source, bash]
----
$ wrk -t 8 -c 200 -d 5s http://127.0.0.1:8080/authors
----


== Database

Before running the code create the database schema using SQL statements from
`scripts/create.sql` and subsequently `scripts/seed.sql`.

Set the proper database connection string in:

* `web-rust/.env`
* `web-python/config/config.toml`

== Preliminary results

Rust.

[source, text]
----
~ ❯ wrk -t 8 -c 200 -d 5s http://localhost:8080/authors
Running 5s test @ http://localhost:8080/authors
  8 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency    13.51ms   33.24ms 327.05ms   89.67%
    Req/Sec    23.77k     7.37k   51.26k    70.43%
  947832 requests in 5.10s, 122.18MB read
  Socket errors: connect 0, read 70, write 0, timeout 0
  Non-2xx or 3xx responses: 938147
Requests/sec: 185818.73
Transfer/sec:     23.95MB
----

Python.


[source, text]
----
~ ❯ wrk -t 8 -c 200 -d 5s http://localhost:8080/authors
Running 5s test @ http://localhost:8080/authors
  8 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   182.11ms  194.11ms   1.29s    90.83%
    Req/Sec   189.98     67.80   360.00     71.94%
  6400 requests in 5.03s, 2.61MB read
  Socket errors: connect 0, read 174, write 0, timeout 0
Requests/sec:   1272.09
Transfer/sec:    531.69KB
----

